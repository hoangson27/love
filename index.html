<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Con Thuy·ªÅn T√¨nh Tr√¥i V·ªÅ Tim Em üåÖ</title>
    <link
      href="https://fonts.googleapis.com/css2?family=Quicksand:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: "Quicksand", sans-serif;
        background: linear-gradient(
          135deg,
          #ffeef8 0%,
          #ffe0f0 25%,
          #ffb3d9 50%,
          #ff99cc 75%,
          #ff80bf 100%
        );
        background-size: 400% 400%;
        animation: gradientFlow 8s ease infinite;
        min-height: 100vh;
        overflow-x: hidden;
        position: relative;
      }

      @keyframes gradientFlow {
        0% {
          background-position: 0% 50%;
        }
        50% {
          background-position: 100% 50%;
        }
        100% {
          background-position: 0% 50%;
        }
      }

      .heart-container {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        pointer-events: none;
        z-index: 1;
      }

      .falling-heart {
        position: absolute;
        color: rgba(255, 105, 180, 0.8);
        font-size: 20px;
        animation: fall linear infinite;
        pointer-events: none;
      }

      @keyframes fall {
        0% {
          transform: translateY(-100px) rotate(0deg);
          opacity: 1;
        }
        100% {
          transform: translateY(100vh) rotate(360deg);
          opacity: 0;
        }
      }

      .game-container {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        min-height: 100vh;
        padding: 20px;
        position: relative;
        z-index: 10;
      }

      .welcome-screen {
        display: flex;
        flex-direction: column;
        align-items: center;
        text-align: center;
        animation: fadeInUp 1s ease-out;
      }

      @keyframes fadeInUp {
        from {
          opacity: 0;
          transform: translateY(30px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      .main-title {
        font-size: 3.5rem;
        font-weight: 700;
        background: linear-gradient(45deg, #ff1744, #ff4569, #ff6b9d);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        margin-bottom: 1rem;
        text-shadow: 0 4px 8px rgba(255, 23, 68, 0.3);
        animation: titlePulse 2s ease-in-out infinite;
      }

      @keyframes titlePulse {
        0%,
        100% {
          transform: scale(1);
        }
        50% {
          transform: scale(1.05);
        }
      }

      .subtitle {
        font-size: 1.3rem;
        color: #d81b60;
        margin-bottom: 2rem;
        font-weight: 500;
        animation: subtitleFloat 3s ease-in-out infinite;
      }

      @keyframes subtitleFloat {
        0%,
        100% {
          transform: translateY(0);
        }
        50% {
          transform: translateY(-5px);
        }
      }

      .heart-decoration {
        font-size: 2rem;
        margin: 1rem 0;
        animation: heartBeat 1.5s ease-in-out infinite;
      }

      @keyframes heartBeat {
        0%,
        100% {
          transform: scale(1);
        }
        50% {
          transform: scale(1.2);
        }
      }

      .user-info-form {
        background: rgba(255, 255, 255, 0.9);
        backdrop-filter: blur(20px);
        border-radius: 25px;
        padding: 30px;
        margin-bottom: 20px;
        box-shadow: 0 20px 40px rgba(255, 105, 180, 0.2);
        border: 2px solid rgba(255, 182, 193, 0.3);
        max-width: 400px;
        width: 100%;
      }

      .form-group {
        margin-bottom: 20px;
        text-align: left;
      }

      .form-label {
        display: block;
        font-size: 1rem;
        font-weight: 600;
        color: #2d3436;
        margin-bottom: 8px;
      }

      .form-input {
        width: 100%;
        padding: 12px 15px;
        border: 2px solid rgba(255, 182, 193, 0.4);
        border-radius: 15px;
        font-size: 1rem;
        font-family: "Quicksand", sans-serif;
        background: rgba(255, 240, 245, 0.8);
        transition: all 0.3s ease;
      }

      .form-input:focus {
        outline: none;
        border-color: #ff69b4;
        background: rgba(255, 255, 255, 0.9);
        box-shadow: 0 0 10px rgba(255, 105, 180, 0.3);
      }

      .btn {
        background: linear-gradient(45deg, #ff4081, #ff6ec7);
        color: white;
        border: none;
        padding: 15px 40px;
        font-size: 1.2rem;
        font-weight: 600;
        border-radius: 50px;
        cursor: pointer;
        box-shadow: 0 8px 25px rgba(255, 64, 129, 0.4);
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        font-family: "Quicksand", sans-serif;
        text-transform: uppercase;
        letter-spacing: 1px;
        position: relative;
        overflow: hidden;
      }

      .btn::before {
        content: "";
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(
          90deg,
          transparent,
          rgba(255, 255, 255, 0.3),
          transparent
        );
        transition: left 0.5s;
      }

      .btn:hover::before {
        left: 100%;
      }

      .btn:hover {
        transform: translateY(-3px) scale(1.05);
        box-shadow: 0 12px 35px rgba(255, 64, 129, 0.6);
      }

      .btn:active {
        transform: translateY(-1px) scale(1.02);
      }

      .btn:disabled {
        opacity: 0.6;
        cursor: not-allowed;
        transform: none;
      }

      .game-screen {
        display: none;
        text-align: center;
        max-width: 600px;
        width: 100%;
        animation: slideIn 0.6s ease-out;
      }

      @keyframes slideIn {
        from {
          opacity: 0;
          transform: translateX(50px);
        }
        to {
          opacity: 1;
          transform: translateX(0);
        }
      }

      .question-card {
        background: rgba(255, 255, 255, 0.9);
        backdrop-filter: blur(20px);
        border-radius: 25px;
        padding: 40px;
        margin-bottom: 30px;
        box-shadow: 0 20px 40px rgba(255, 105, 180, 0.2);
        border: 2px solid rgba(255, 182, 193, 0.3);
      }

      .question-number {
        background: linear-gradient(45deg, #ff4081, #ff6ec7);
        color: white;
        padding: 8px 20px;
        border-radius: 20px;
        font-size: 0.9rem;
        font-weight: 600;
        display: inline-block;
        margin-bottom: 20px;
      }

      .question-text {
        font-size: 1.5rem;
        color: #2d3436;
        margin-bottom: 30px;
        font-weight: 600;
        line-height: 1.4;
      }

      .options-container {
        display: grid;
        gap: 15px;
        margin-bottom: 20px;
      }

      .option-btn {
        background: rgba(255, 240, 245, 0.8);
        color: #2d3436;
        border: 2px solid rgba(255, 182, 193, 0.4);
        padding: 18px 25px;
        border-radius: 20px;
        cursor: pointer;
        font-size: 1.1rem;
        font-weight: 500;
        transition: all 0.3s ease;
        font-family: "Quicksand", sans-serif;
        position: relative;
        overflow: hidden;
      }

      .option-btn::before {
        content: "";
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(
          90deg,
          transparent,
          rgba(255, 105, 180, 0.1),
          transparent
        );
        transition: left 0.5s;
      }

      .option-btn:hover::before {
        left: 100%;
      }

      .option-btn:hover {
        background: rgba(255, 105, 180, 0.1);
        border-color: #ff69b4;
        transform: translateY(-2px);
        box-shadow: 0 8px 20px rgba(255, 105, 180, 0.3);
      }

      .response-message {
        display: none;
        background: linear-gradient(45deg, #ff9a9e, #fecfef);
        color: #2d3436;
        padding: 20px;
        border-radius: 20px;
        margin: 20px 0;
        font-size: 1.2rem;
        font-weight: 600;
        animation: messageSlideIn 0.5s ease-out;
        box-shadow: 0 10px 25px rgba(255, 154, 158, 0.3);
      }

      @keyframes messageSlideIn {
        from {
          opacity: 0;
          transform: scale(0.8);
        }
        to {
          opacity: 1;
          transform: scale(1);
        }
      }

      .final-screen {
        display: none;
        text-align: center;
        animation: finalFadeIn 1s ease-out;
      }

      @keyframes finalFadeIn {
        from {
          opacity: 0;
          transform: scale(0.8);
        }
        to {
          opacity: 1;
          transform: scale(1);
        }
      }

      .heart-unlock {
        font-size: 8rem;
        color: #ff1744;
        margin: 30px 0;
        animation: heartUnlock 2s ease-in-out;
      }

      @keyframes heartUnlock {
        0% {
          transform: scale(0) rotate(-180deg);
          opacity: 0;
        }
        50% {
          transform: scale(1.2) rotate(0deg);
          opacity: 1;
        }
        100% {
          transform: scale(1) rotate(0deg);
          opacity: 1;
        }
      }

      .final-message {
        background: linear-gradient(45deg, #ffd700, #ffed4e);
        padding: 30px;
        border-radius: 25px;
        margin: 30px 0;
        box-shadow: 0 15px 35px rgba(255, 215, 0, 0.3);
        border: 3px solid rgba(255, 215, 0, 0.5);
      }

      .final-title {
        font-size: 2.2rem;
        color: #2d3436;
        margin-bottom: 15px;
        font-weight: 700;
      }

      .final-text {
        font-size: 1.3rem;
        color: #2d3436;
        font-weight: 600;
        line-height: 1.5;
      }

      .result-summary {
        background: rgba(255, 255, 255, 0.9);
        padding: 20px;
        border-radius: 20px;
        margin: 20px 0;
        text-align: left;
        font-size: 1rem;
        color: #2d3436;
      }

      .celebration-hearts {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        pointer-events: none;
        z-index: 9999;
      }

      .celebration-heart {
        position: absolute;
        font-size: 30px;
        color: #ff1744;
        animation: celebrate 3s ease-out forwards;
      }

      @keyframes celebrate {
        0% {
          transform: scale(0) rotate(0deg);
          opacity: 1;
        }
        50% {
          transform: scale(1.5) rotate(180deg);
          opacity: 1;
        }
        100% {
          transform: scale(1) rotate(360deg) translateY(-200px);
          opacity: 0;
        }
      }

      .progress-container {
        width: 100%;
        height: 6px;
        background: rgba(255, 255, 255, 0.3);
        border-radius: 10px;
        margin-bottom: 30px;
        overflow: hidden;
      }

      .progress-bar {
        height: 100%;
        background: linear-gradient(45deg, #ff4081, #ff6ec7);
        border-radius: 10px;
        transition: width 0.5s ease;
        width: 0%;
      }

      .loading-indicator {
        display: none;
        text-align: center;
        padding: 20px;
      }

      .loading-spinner {
        width: 40px;
        height: 40px;
        border: 4px solid rgba(255, 105, 180, 0.3);
        border-top: 4px solid #ff69b4;
        border-radius: 50%;
        animation: spin 1s linear infinite;
        margin: 0 auto 15px;
      }

      @keyframes spin {
        0% {
          transform: rotate(0deg);
        }
        100% {
          transform: rotate(360deg);
        }
      }

      .loading-text {
        color: #d81b60;
        font-weight: 600;
        font-size: 1.1rem;
      }

      .status-message {
        padding: 15px;
        border-radius: 15px;
        margin: 15px 0;
        font-weight: 600;
        text-align: center;
      }

      .status-success {
        background: linear-gradient(45deg, #4caf50, #81c784);
        color: white;
      }

      .status-error {
        background: linear-gradient(45deg, #f44336, #ef5350);
        color: white;
      }

      @media (max-width: 768px) {
        .main-title {
          font-size: 2.5rem;
        }

        .subtitle {
          font-size: 1.1rem;
        }

        .btn {
          padding: 12px 30px;
          font-size: 1rem;
        }

        .question-card,
        .user-info-form {
          padding: 25px;
        }

        .question-text {
          font-size: 1.3rem;
        }

        .option-btn {
          padding: 15px 20px;
          font-size: 1rem;
        }

        .heart-unlock {
          font-size: 6rem;
        }

        .final-title {
          font-size: 1.8rem;
        }
      }

      @media (max-width: 480px) {
        .main-title {
          font-size: 2rem;
        }

        .game-container {
          padding: 15px;
        }

        .question-card,
        .user-info-form {
          padding: 20px;
        }

        .heart-unlock {
          font-size: 5rem;
        }
      }

      .hidden {
        display: none !important;
      }
    </style>
  </head>
  <body>
    <div class="heart-container" id="heartContainer"></div>

    <div class="game-container">
      <div class="welcome-screen" id="welcomeScreen">
        <h1 class="main-title">Thuy·ªÅn C·∫≠p B·∫øn ‚Äì L√≤ng D·ªãu √äm</h1>
        <div class="heart-decoration">üå∏üíñüòã</div>
        <p class="subtitle">
          Kh√°m ph√° b·∫£n th√¢n m√¨nh qua 5 c√¢u h·ªèi th√∫ v·ªã n√®! üåü
        </p>

        <div class="user-info-form">
          <div class="form-group">
            <label class="form-label" for="playerName"
              >T√™n c·ªßa b·∫°n üå∏</label
            >
            <input
              type="text"
              id="playerName"
              class="form-input"
              placeholder="Nh·∫≠p t√™n b·∫°n nha..."
              value=""
              required
            />
          </div>
          <div class="form-group">
            <label class="form-label" for="playerEmail">Email c·ªßa b·∫°n üì¨</label>
            <input
              type="email"
              id="playerEmail"
              class="form-input"
              placeholder="email@example.com"
              required
            />
          </div>
          <div class="form-group">
            <label class="form-label" for="playerAge">Tu·ªïi c·ªßa b·∫°n üåü</label>
            <input
              type="number"
              id="playerAge"
              class="form-input"
              placeholder="Nh·∫≠p tu·ªïi nha..."
              min="18"
              max="100"
              value="19"
            />
          </div>
        </div>

        <button class="btn" onclick="startGame()" id="startBtn">
          üå∏ B·∫Øt ƒê·∫ßu Kh√°m Ph√°
        </button>

        <div id="statusMessage"></div>
      </div>

      <div class="game-screen" id="gameScreen">
        <div class="progress-container">
          <div class="progress-bar" id="progressBar"></div>
        </div>

        <div class="question-card">
          <div class="question-number" id="questionNumber"></div>
          <h2 class="question-text" id="questionText"></h2>
          <div class="options-container" id="optionsContainer"></div>
          <div class="response-message" id="responseMessage"></div>
        </div>
      </div>

      <div class="final-screen" id="finalScreen">
        <div class="loading-indicator" id="finalLoadingIndicator">
          <div class="loading-spinner"></div>
          <div class="loading-text">ƒêang ph√¢n l·ªçc th√¥ng tin c·ªßa b·∫°n... üíï</div>
        </div>

        <div id="finalContent" style="display: none">
          <div class="heart-unlock">‚ú®</div>
          <div class="final-message">
            <h2 class="final-title">K·∫øt Qu·∫£ C·ªßa B·∫°n! üéâ</h2>
            <p class="final-text" id="finalResultText">
              Wow, b·∫°n th·ª±c s·ª± ƒë·∫∑c bi·ªát! H√£y xem b·∫°n thu·ªôc nh√≥m t√≠nh c√°ch n√†o nha! üíï
            </p>
          </div>

          <div class="result-summary" id="resultSummary"></div>

          <button class="btn" onclick="restartGame()">
            üîÑ L√†m L·∫°i N√†o
          </button>
        </div>
      </div>
    </div>

    <script>
      const GOOGLE_SCRIPT_URL =
        "https://script.google.com/macros/s/AKfycbxhZluU9t4p8MqsAeUc3q20CtQ0XaUq4R5Pxvg7h0Xi3ZUbhVeyjL8Tp2plh_7ti5NzqQ/exec";

      const questions = [
  {
    question: "B·∫°n th√≠ch d√†nh th·ªùi gian trong khung gi·ªù n√†o nh·∫•t? üå∏",
    options: [
      "‚òÄÔ∏è S√°ng s·ªõm - th√≠ch s·ª± y√™n tƒ©nh v√† nƒÉng l∆∞·ª£ng m·ªõi m·∫ª",
      "‚òï S√°ng mu·ªôn - th∆∞ gi√£n v·ªõi ly c√† ph√™ v√† kh√¥ng gian ·∫•m c√∫ng",
      "üåô T·ªëi mu·ªôn - t·∫≠n h∆∞·ªüng s·ª± tƒ©nh l·∫∑ng v√† nh·ªØng suy nghƒ© s√¢u s·∫Øc",
      "üòã B·∫•t c·ª© l√∫c n√†o - mi·ªÖn l√† vui v·∫ª v√† c√≥ ng∆∞·ªùi tr√≤ chuy·ªán",
    ],
    responses: [
      "Wow, b·∫°n l√† ng∆∞·ªùi y√™u th√≠ch s·ª± kh·ªüi ƒë·∫ßu t∆∞∆°i m·ªõi! ‚òÄÔ∏è",
      "C√† ph√™ v√† kh√¥ng gian ·∫•m c√∫ng, b·∫°n bi·∫øt t·∫≠n h∆∞·ªüng cu·ªôc s·ªëng ƒë√≥! ‚òï",
      "T√¢m h·ªìn s√¢u s·∫Øc, b·∫°n th√≠ch nh·ªØng kho·∫£nh kh·∫Øc tƒ©nh l·∫∑ng! üåô",
      "NƒÉng l∆∞·ª£ng t√≠ch c·ª±c, b·∫°n l√†m m·ªçi th·ª© tr·ªü n√™n vui v·∫ª! üòã",
    ],
  },
  {
    question: "ƒêi·ªÅu g√¨ khi·∫øn b·∫°n c·∫£m th·∫•y h·∫°nh ph√∫c nh·∫•t? üíñ",
    options: [
      "üéÅ Nh·∫≠n ƒë∆∞·ª£c nh·ªØng m√≥n qu√† nh·ªè b·∫•t ng·ªù t·ª´ ng∆∞·ªùi quan t√¢m",
      "üìù ƒê∆∞·ª£c ai ƒë√≥ l·∫Øng nghe v√† th·∫•u hi·ªÉu nh·ªØng t√¢m t∆∞ c·ªßa m√¨nh",
      "üåü C·∫£m th·∫•y ƒë∆∞·ª£c y√™u th∆∞∆°ng qua nh·ªØng h√†nh ƒë·ªông quan t√¢m nh·ªè",
      "üòÜ C∆∞·ªùi ƒëau b·ª•ng v·ªõi nh·ªØng c√¢u chuy·ªán h√†i h∆∞·ªõc",
    ],
    responses: [
      "M√≥n qu√† nh·ªè nh∆∞ng t√¨nh c·∫£m to l·ªõn, b·∫°n th·∫≠t ƒë√°ng y√™u! üéÄ",
      "ƒê∆∞·ª£c th·∫•u hi·ªÉu l√† ƒëi·ªÅu qu√Ω gi√° nh·∫•t ƒë√∫ng kh√¥ng? üíå",
      "Nh·ªØng h√†nh ƒë·ªông nh·ªè ch·ª©a ƒë·ª±ng t√¨nh y√™u l·ªõn! üå∑",
      "Ti·∫øng c∆∞·ªùi l√† li·ªÅu thu·ªëc t·ªët nh·∫•t! üòÑ",
    ],
  },
  {
    question: "Khi g·∫∑p kh√≥ khƒÉn, b·∫°n th∆∞·ªùng l√†m g√¨? ü§î",
    options: [
      "üß≠ T·ª± m√¨nh t√¨m c√°ch gi·∫£i quy·∫øt v√† h·ªçc h·ªèi t·ª´ tr·∫£i nghi·ªám",
      "üì≤ T√¨m ng∆∞·ªùi tin t∆∞·ªüng ƒë·ªÉ chia s·∫ª v√† xin l·ªùi khuy√™n",
      "üòú C·ªë g·∫Øng gi·ªØ tinh th·∫ßn t√≠ch c·ª±c v√† t√¨m ƒëi·ªÅu vui trong ho√†n c·∫£nh kh√≥ khƒÉn",
      "üö£‚Äç‚ôÇÔ∏è Im l·∫∑ng suy nghƒ© cho ƒë·∫øn khi t√¨m ra h∆∞·ªõng gi·∫£i quy·∫øt",
    ],
    responses: [
      "B·∫°n l√† ng∆∞·ªùi ƒë·ªôc l·∫≠p v√† m·∫°nh m·∫Ω! üíì",
      "Bi·∫øt t√¨m ki·∫øm s·ª± h·ªó tr·ª£ l√† ƒëi·ªÅu th√¥ng minh! üì©",
      "L·∫°c quan trong kh√≥ khƒÉn, b·∫°n th·∫≠t tuy·ªát v·ªùi! üòä",
      "Suy nghƒ© k·ªπ l∆∞·ª°ng tr∆∞·ªõc khi h√†nh ƒë·ªông, r·∫•t kh√¥n ngoan! ‚òÅÔ∏è",
    ],
  },
  {
    question: "M√≥n qu√† n√†o b·∫°n th√≠ch nh·∫≠n nh·∫•t? üéÅ",
    options: [
      "üåπ Hoa t∆∞∆°i k√®m l·ªùi nh·∫Øn ng·ªçt ng√†o",
      "üç™ ƒê·ªì ƒÉn ngon ƒë∆∞·ª£c l√†m t·∫≠n tay",
      "üìñ S√°ch ho·∫∑c nh·∫≠t k√Ω v·ªõi nh·ªØng d√≤ng ghi ch√∫ c√° nh√¢n",
      "üß∏ ƒê·ªì v·∫≠t d·ªÖ th∆∞∆°ng ƒë·ªÉ l√†m k·ª∑ ni·ªám",
    ],
    responses: [
      "Hoa v√† l·ªùi ng·ªçt ng√†o, b·∫°n th√≠ch s·ª± l√£ng m·∫°n! üå∑",
      "ƒê·ªì ƒÉn l√†m b·∫±ng t√¨nh y√™u th∆∞∆°ng, th·∫≠t √Ω nghƒ©a! üç∞",
      "Nh·ªØng d√≤ng ch·ªØ ch·ª©a ƒë·ª±ng t√¢m t∆∞, r·∫•t c·∫£m ƒë·ªông! üìñ",
      "K·ª∑ v·∫≠t ƒë√°ng y√™u ƒë·ªÉ l∆∞u gi·ªØ k·ª∑ ni·ªám! üß∏",
    ],
  },
  {
    question: "Bu·ªïi h·∫πn l√Ω t∆∞·ªüng c·ªßa b·∫°n l√† g√¨? üíï",
    options: [
      "üåÖ Ng·∫Øm b√¨nh minh/ho√†ng h√¥n ·ªü n∆°i y√™n tƒ©nh",
      "‚òï U·ªëng c√† ph√™ v√† tr√≤ chuy·ªán s√¢u s·∫Øc",
      "üéß Nghe nh·∫°c v√† chia s·∫ª s·ªü th√≠ch c√πng nhau",
      "üåä ƒêi d·∫°o v√† n√≥i chuy·ªán v·ªÅ m·ªçi th·ª© tr√™n ƒë·ªùi",
    ],
    responses: [
      "Thi√™n nhi√™n v√† kho·∫£nh kh·∫Øc y√™n b√¨nh, th·∫≠t l√£ng m·∫°n! ‚òÄÔ∏è",
      "C√† ph√™ v√† cu·ªôc tr√≤ chuy·ªán s√¢u s·∫Øc, tuy·ªát v·ªùi! ‚òï",
      "√Çm nh·∫°c k·∫øt n·ªëi t√¢m h·ªìn, r·∫•t ƒë·∫πp! üé∂",
      "Nh·ªØng cu·ªôc tr√≤ chuy·ªán t·ª± nhi√™n v√† ch√¢n th·∫≠t! üåä",
    ],
  },
];


      const personalityTypes = [
  {
    name: "üåÖ C√¥ G√°i L√£ng M·∫°n",
    description:
      "B·∫°n l√† ng∆∞·ªùi y√™u th√≠ch s·ª± l√£ng m·∫°n v√† nh·ªØng kho·∫£nh kh·∫Øc ƒë·∫πp trong cu·ªôc s·ªëng. B·∫°n c√≥ t√¢m h·ªìn nh·∫°y c·∫£m, bi·∫øt tr√¢n tr·ªçng v·∫ª ƒë·∫πp nh·ªè b√© v√† lu√¥n t√¨m ki·∫øm nh·ªØng tr·∫£i nghi·ªám √Ω nghƒ©a.",
    emoji: "üíñ‚ú®",
  },
  {
    name: "üòé C√¥ G√°i NƒÉng ƒê·ªông",
    description:
      "B·∫°n mang trong m√¨nh nƒÉng l∆∞·ª£ng t√≠ch c·ª±c v√† kh·∫£ nƒÉng l√†m vui l√≤ng m·ªçi ng∆∞·ªùi xung quanh. B·∫°n l·∫°c quan, h√†i h∆∞·ªõc v√† lu√¥n bi·∫øt c√°ch t√¨m ra ƒëi·ªÅu t√≠ch c·ª±c trong m·ªçi ho√†n c·∫£nh.",
    emoji: "üéâüòé",
  },
  {
    name: "ü§ó C√¥ G√°i ·∫§m √Åp",
    description:
      "B·∫°n l√† ng∆∞·ªùi r·∫•t quan t√¢m ƒë·∫øn c·∫£m x√∫c v√† m·ªëi quan h·ªá v·ªõi m·ªçi ng∆∞·ªùi. B·∫°n c√≥ tr√°i tim nh√¢n h·∫≠u, lu√¥n l·∫Øng nghe v√† mang ƒë·∫øn s·ª± ·∫•m √°p cho nh·ªØng ng∆∞·ªùi xung quanh.",
    emoji: "üåüü•∞",
  },
  {
    name: "üíå C√¥ G√°i Duy√™n D√°ng",
    description:
      "B·∫°n c√≥ phong c√°ch giao ti·∫øp duy√™n d√°ng v√† cu·ªën h√∫t. B·∫°n bi·∫øt c√°ch t·∫°o ra nh·ªØng kho·∫£nh kh·∫Øc ƒë·∫∑c bi·ªát v√† ƒë·ªÉ l·∫°i ·∫•n t∆∞·ª£ng s√¢u s·∫Øc trong l√≤ng m·ªçi ng∆∞·ªùi.",
    emoji: "üíïüå∏",
  },
];


      let currentQuestion = 0;
      let gameStarted = false;
      let sessionId = "";
      let playerData = {
        name: "",
        email: "",
        age: "",
        answers: [],
        startTime: null,
        endTime: null,
        finalResult: null,
      };

      async function saveSessionToGoogleSheets(sessionData) {
        try {
          const response = await fetch(GOOGLE_SCRIPT_URL, {
            method: "POST",
            mode: "no-cors",
            headers: {
              "Content-Type": "application/json",
            },
            body: JSON.stringify(sessionData),
          });

          return true;
        } catch (error) {
          console.error("Error saving to Google Sheets:", error);
          return false;
        }
      }

      function showStatusMessage(message, type = "success") {
        const statusDiv = document.getElementById("statusMessage");
        statusDiv.innerHTML = `<div class="status-message status-${type}">${message}</div>`;

        setTimeout(() => {
          statusDiv.innerHTML = "";
        }, 3000);
      }

      function generateSessionId() {
        return Date.now().toString(36) + Math.random().toString(36).substr(2);
      }

      function validateUserInfo() {
        const name = document.getElementById("playerName").value.trim();
        const email = document.getElementById("playerEmail").value.trim();
        const age = document.getElementById("playerAge").value.trim();

        if (!name) {
          showStatusMessage("H√£y nh·∫≠p t√™n c·ªßa b·∫°n nha! üòä", "error");
          return false;
        }

        if (!email) {
          showStatusMessage("Email kh√¥ng th·ªÉ b·ªè tr·ªëng! üì¨", "error");
          return false;
        }

        if (!email.includes("@")) {
          showStatusMessage("Email kh√¥ng h·ª£p l·ªá, vui l√≤ng ki·ªÉm tra l·∫°i! üòú", "error");
          return false;
        }

        if (age && (age < 13 || age > 100)) {
          showStatusMessage("Tu·ªïi ph·∫£i t·ª´ 13 ƒë·∫øn 100! üåü", "error");
          return false;
        }

        playerData.name = name;
        playerData.email = email;
        playerData.age = age;
        playerData.startTime = new Date().toISOString();
        sessionId = generateSessionId();

        return true;
      }

      async function startGame() {
        if (!validateUserInfo()) {
          return;
        }

        document.getElementById("startBtn").disabled = true;

        gameStarted = true;
        currentQuestion = 0;
        playerData.answers = [];

        document.getElementById("welcomeScreen").classList.add("hidden");
        document.getElementById("gameScreen").style.display = "block";
        showQuestion();
        updateProgress();

        showStatusMessage(`B·∫Øt ƒë·∫ßu kh√°m ph√° b·∫£n th√¢n n√†o! üå∏`, "success");
      }

      function showQuestion() {
        const question = questions[currentQuestion];
        document.getElementById("questionNumber").textContent = `C√¢u ${
          currentQuestion + 1
        }/${questions.length}`;
        document.getElementById("questionText").textContent = question.question;

        const optionsContainer = document.getElementById("optionsContainer");
        optionsContainer.innerHTML = "";

        question.options.forEach((option, index) => {
          const button = document.createElement("button");
          button.className = "option-btn";
          button.textContent = option;
          button.onclick = () => selectAnswer(index);
          optionsContainer.appendChild(button);
        });

        document.getElementById("responseMessage").style.display = "none";
      }

      async function selectAnswer(answerIndex) {
        const question = questions[currentQuestion];
        const response = question.responses[answerIndex];

        playerData.answers.push({
          questionIndex: currentQuestion + 1,
          question: question.question,
          selectedOption: question.options[answerIndex],
          optionIndex: answerIndex,
          response: response,
        });

        const responseElement = document.getElementById("responseMessage");
        responseElement.textContent = response;
        responseElement.style.display = "block";

        createHeartBurst();

        const optionButtons = document.querySelectorAll(".option-btn");
        optionButtons.forEach((btn) => {
          btn.disabled = true;
          btn.style.opacity = "0.6";
        });

        setTimeout(() => {
          if (currentQuestion < questions.length - 1) {
            currentQuestion++;
            showQuestion();
            updateProgress();
          } else {
            finishGame();
          }
        }, 2500);
      }

      function updateProgress() {
        const progress = ((currentQuestion + 1) / questions.length) * 100;
        document.getElementById("progressBar").style.width = progress + "%";
      }

      function calculateFinalResult() {
        const answerCounts = [0, 0, 0, 0];

        playerData.answers.forEach((answer) => {
          answerCounts[answer.optionIndex]++;
        });

        const maxCount = Math.max(...answerCounts);
        const dominantType = answerCounts.indexOf(maxCount);

        return personalityTypes[dominantType];
      }

      async function finishGame() {
        playerData.endTime = new Date().toISOString();
        playerData.finalResult = calculateFinalResult();

        document.getElementById("gameScreen").style.display = "none";
        document.getElementById("finalScreen").style.display = "block";
        document.getElementById("finalLoadingIndicator").style.display = "block";

        const sessionData = {
          sessionId: sessionId,
          timestamp: new Date().toISOString(),
          name: playerData.name,
          email: playerData.email,
          age: playerData.age,
          startTime: playerData.startTime,
          endTime: playerData.endTime,
          totalQuestions: questions.length,
          answer1: playerData.answers[0]?.selectedOption || "",
          answer2: playerData.answers[1]?.selectedOption || "",
          answer3: playerData.answers[2]?.selectedOption || "",
          answer4: playerData.answers[3]?.selectedOption || "",
          answer5: playerData.answers[4]?.selectedOption || "",
          answerIndex1: playerData.answers[0]?.optionIndex + 1 || "",
          answerIndex2: playerData.answers[1]?.optionIndex + 1 || "",
          answerIndex3: playerData.answers[2]?.optionIndex + 1 || "",
          answerIndex4: playerData.answers[3]?.optionIndex + 1 || "",
          answerIndex5: playerData.answers[4]?.optionIndex + 1 || "",
          personalityType: playerData.finalResult.name,
          personalityDescription: playerData.finalResult.description,
          personalityEmoji: playerData.finalResult.emoji,
          allAnswers: playerData.answers.map((a) => a.selectedOption).join(" | "),
          gameCompleted: true,
        };

        const saveSuccess = await saveSessionToGoogleSheets(sessionData);

        document.getElementById("finalLoadingIndicator").style.display = "none";
        document.getElementById("finalContent").style.display = "block";

        document.getElementById("finalResultText").innerHTML = 
          `Ch√∫c m·ª´ng ${playerData.name}! B·∫°n ƒë√£ ho√†n th√†nh b√†i test ! üíï<br>
          H√£y xem k·∫øt qu·∫£ th√∫ v·ªã v·ªÅ t√≠nh c√°ch c·ªßa b·∫°n nha! üå∏<br>
          <br><strong>K·∫øt qu·∫£: ${playerData.finalResult.name}</strong>`;

        const summaryHtml = `
          <h3>üåü K·∫øt qu·∫£ kh√°m ph√° b·∫£n th√¢n c·ªßa ${playerData.name}:</h3>
          <p><strong>Lo·∫°i t√≠nh c√°ch:</strong> ${playerData.finalResult.name}</p>
          <p><strong>M√¥ t·∫£:</strong> ${playerData.finalResult.description}</p>
          <hr style="margin: 15px 0; border: 1px solid rgba(255,182,193,0.3);">
          <p><strong>C√°c l·ª±a ch·ªçn c·ªßa b·∫°n:</strong></p>
          ${playerData.answers.map((answer, index) => 
            `<p><strong>C√¢u ${index + 1}:</strong> ${answer.selectedOption}</p>`
          ).join("")}
          <hr style="margin: 15px 0; border: 1px solid rgba(255,182,193,0.3);">
          <h3>üíï L·ªùi nh·∫≠n x√©t:</h3>
          <p>B·∫°n l√† m·ªôt ng∆∞·ªùi th·∫≠t ƒë·∫∑c bi·ªát v·ªõi nh·ªØng ƒë·∫∑c ƒëi·ªÉm t√≠nh c√°ch r·∫•t ƒë√°ng y√™u! M·ªói l·ª±a ch·ªçn c·ªßa b·∫°n ƒë·ªÅu th·ªÉ hi·ªán m·ªôt kh√≠a c·∫°nh th√∫ v·ªã c·ªßa b·∫£n th√¢n. H√£y ti·∫øp t·ª•c ph√°t huy nh·ªØng ƒëi·ªÉm m·∫°nh v√† lu√¥n t·ª± tin v√†o con ng∆∞·ªùi m√¨nh nh√©! ‚ú®</p>
          <p><strong>C·∫£m ∆°n ${playerData.name} ƒë√£ tham gia!</strong> Hy v·ªçng b·∫°n ƒë√£ c√≥ nh·ªØng ph√∫t gi√¢y th√∫ v·ªã khi kh√°m ph√° b·∫£n th√¢n m√¨nh! üå∏</p>
        `;

        document.getElementById("resultSummary").innerHTML = summaryHtml;

        createCelebration();

        if (!saveSuccess) {
          showStatusMessage("C√≥ l·ªói nh·ªè khi l∆∞u d·ªØ li·ªáu, nh∆∞ng k·∫øt qu·∫£ v·∫´n hi·ªÉn th·ªã b√¨nh th∆∞·ªùng! üòÖ", "error");
        }
      }

      function restartGame() {
        currentQuestion = 0;
        playerData.answers = [];
        sessionId = "";
        document.getElementById("finalScreen").style.display = "none";
        document.getElementById("welcomeScreen").classList.remove("hidden");
        document.getElementById("progressBar").style.width = "0%";
        document.getElementById("startBtn").disabled = false;

        document.getElementById("playerName").value = "Th∆∞";
        document.getElementById("playerEmail").value = "";
        document.getElementById("playerAge").value = "19";
      }

      function createFallingHeart() {
        const heart = document.createElement("div");
        heart.className = "falling-heart";
        heart.innerHTML = ["üíñ", "üíï", "üíó", "üíù", "üíò"][Math.floor(Math.random() * 5)];
        heart.style.left = Math.random() * 100 + "vw";
        heart.style.animationDuration = Math.random() * 3 + 2 + "s";
        heart.style.fontSize = Math.random() * 10 + 15 + "px";

        document.getElementById("heartContainer").appendChild(heart);

        setTimeout(() => {
          heart.remove();
        }, 5000);
      }

      function createHeartBurst() {
        for (let i = 0; i < 8; i++) {
          setTimeout(() => {
            const heart = document.createElement("div");
            heart.innerHTML = "üíñ";
            heart.style.position = "fixed";
            heart.style.left = Math.random() * 100 + "vw";
            heart.style.top = Math.random() * 100 + "vh";
            heart.style.fontSize = "25px";
            heart.style.pointerEvents = "none";
            heart.style.zIndex = "9999";
            heart.style.animation = "celebrate 2s ease-out forwards";
            document.body.appendChild(heart);

            setTimeout(() => heart.remove(), 2000);
          }, i * 100);
        }
      }

      function createCelebration() {
        const celebrationContainer = document.createElement("div");
        celebrationContainer.className = "celebration-hearts";
        document.body.appendChild(celebrationContainer);

        for (let i = 0; i < 20; i++) {
          setTimeout(() => {
            const heart = document.createElement("div");
            heart.className = "celebration-heart";
            heart.innerHTML = ["üíñ", "üíï", "üíó", "üíù", "üíò", "‚ù§Ô∏è"][Math.floor(Math.random() * 6)];
            heart.style.left = Math.random() * 100 + "vw";
            heart.style.top = Math.random() * 100 + "vh";
            celebrationContainer.appendChild(heart);
          }, i * 150);
        }

        setTimeout(() => {
          celebrationContainer.remove();
        }, 4000);
      }

      function createSparkle() {
        const sparkle = document.createElement("div");
        sparkle.innerHTML = "‚ú®";
        sparkle.style.position = "fixed";
        sparkle.style.left = Math.random() * 100 + "vw";
        sparkle.style.top = Math.random() * 100 + "vh";
        sparkle.style.fontSize = "20px";
        sparkle.style.pointerEvents = "none";
        sparkle.style.zIndex = "5";
        sparkle.style.animation = "sparkleFloat 4s ease-out forwards";
        document.body.appendChild(sparkle);

        setTimeout(() => sparkle.remove(), 4000);
      }

      setInterval(createFallingHeart, 800);

      const sparkleStyle = document.createElement("style");
      sparkleStyle.textContent = `
        @keyframes sparkleFloat {
          0% { opacity: 1; transform: translateY(0) rotate(0deg); }
          100% { opacity: 0; transform: translateY(-150px) rotate(360deg); }
        }
      `;
      document.head.appendChild(sparkleStyle);

      setInterval(createSparkle, 3000);
    </script>
  </body>
</html>